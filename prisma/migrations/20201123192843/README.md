# Migration `20201123192843`

This migration has been generated by Davi Suga at 11/23/2020, 4:28:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
"id" SERIAL,
    "email" TEXT NOT NULL,
    "name" TEXT NOT NULL,
    "password" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Lesson" (
"id" SERIAL,
    "title" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "url" TEXT NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Exercise" (
"id" SERIAL,
    "title" TEXT NOT NULL,
    "description" TEXT NOT NULL,
    "url" TEXT NOT NULL,
    "answer" TEXT NOT NULL,
    "grade" INTEGER NOT NULL,
    "lessonId" INTEGER NOT NULL,
    "choices" TEXT[],

    PRIMARY KEY ("id")
)

CREATE TABLE "Progress" (
"id" SERIAL,
    "user_id" INTEGER,
    "start_id" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "end_datetime" TIMESTAMP(3),
    "lessonId" INTEGER,

    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "User.email_unique" ON "User"("email")

CREATE UNIQUE INDEX "Progress_user_id_unique" ON "Progress"("user_id")

ALTER TABLE "Exercise" ADD FOREIGN KEY("lessonId")REFERENCES "Lesson"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Progress" ADD FOREIGN KEY("user_id")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Progress" ADD FOREIGN KEY("lessonId")REFERENCES "Lesson"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201123192843
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,50 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+datasource db {
+  provider = "postgres"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id       Int      @id @default(autoincrement())
+  email    String   @unique
+  name     String
+  password String
+  progress Progress // relation scalar field (used in the `@relation` attribute above)
+
+}
+
+model Lesson {
+  id          Int        @id @default(autoincrement())
+  title       String
+  description String
+  url         String
+  Progress    Progress[]
+  exercises Exercise[]
+}
+
+model Exercise {
+  id          Int    @id @default(autoincrement())
+  title       String
+  description String
+  url         String
+  answer      String
+  grade       Int
+  lesson Lesson @relation(fields: [lessonId], references:[id])
+  lessonId Int
+  choices String[]
+}
+
+model Progress {
+  id           Int       @id @default(autoincrement())
+  user         User?     @relation(fields: [user_id], references: [id])
+  user_id      Int?
+  start_id     DateTime  @default(now())
+  end_datetime DateTime?
+  lesson       Lesson?   @relation(fields: [lessonId], references: [id])
+  lessonId     Int?
+}
```


